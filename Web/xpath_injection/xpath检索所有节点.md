## 检索所有节点！

在SQL注入中，UNION关键字将SELECT查询的输出连接到一个结果集中。 XPath中的等价物是管道字符。如果X和Y是查询，我们可以说X | Y返回X的结果以及Y的结果。如果我们想要返回XML数据集中的每个节点，则查询将为：

我们的注入需要将查询的第一部分和第二部分转换为完整且语法正确的XPath查询，它们不返回任何数据，并将查询的结果与数据库中所有节点的查询结合起来。如果查询如下所示：

`/xmlfile/users/user[username='OUR_INPUT']/username`

我们必须在输入之前完成这两部分：

`/xmlfile/users/user[username='`

我们可以用字符串`a']`来做到这一点，这使得集合中的第一个查询看起来是这样的：

`/xmlfile/users/user[username='a']`

我们还需要完成输入后的部分：

`']/username`

重要的是要注意，无效的节点名称不会导致查询失败，它们只会返回任何结果。因此，我们可以使用前缀`/a['a`将输入后的部分转换为以下查询：

/a['a']/username

现在我们需要做的就是使用管道符`|`将我们的所有节点查询连接到两个查询，这看起来像`|/*|`当你把它放在一起。总而言之，我们生成的查询将如下所示：

`/xmlfile/users/user[username='a']|/*|/a['a']`

所以，挑战1的正确答案是：

a']|/*|/a['a