POWERSHELL赋值运算符

在本教程中，我们将通过`PowerShell Assignement Operators`。这些运算符将一个值赋给一个变量的多个值。赋值运算符也可以在赋值给变量之前执行数值运算。我们将通过PowerShell赋值操作符的列表，并查看几个关于它们的示例，这些示例将帮助您了解它们能够执行的操作以及它们的用法。以下是由Microsoft提供的PowerShell支持的赋值运算符列表：

*   `= `：将变量的值设置为指定的值。
*   `+= `：按指定值增加变量的值，或将指定值附加到现有值。
*   `*= `：将变量的值乘以指定的值，或将指定的值附加到现有的值。
*   `/= `：将变量的值除以指定的值。
*   `%= `：将变量的值除以指定的值，然后将余数（模数）赋予变量。
*   `++ `：将变量，可指定属性或数组元素的值增加1。
*   `-- ` :将变量，可指定属性或数组元素的值减1。

### 变量
按照微软的说法，变量被命名为存储值的内存空间。为了给变量赋值，我们必须使用`=`运算符。当我们使用赋值运算符来存储一个值或多个值时，如果变量不存在，它将被创建。如果该变量存在，则该值将被您分配的新值替换。PowerShell变量没有任何特定的类型。变量将根据存储在其中的值采用其数据类型。如果项目集合存储在变量中，那么变量的数据类型将变为System.Object，并且您将能够在其中存储任何数据类型。

### `=` 赋值运算符
以下您将看到几种关于如何使用赋值运算符将值存储在变量中的方法。

为变量提供一个数字 $a = 5

给变量提供一个字符串 $a = "Hello World" 

提供多个值来创建一个数组 $a = "This" , "is" , "an" , "array"

提供键/值对来创建哈希表 $a = @{1 = "This" ; 2 = "is" ; 3 = "a" ; 4 = "hash" ; 5 = "table"} 

提供十六进制值$a = 0x37  （十进制值：55 - 该值以十进制转换）

提供指数$a = 5.55e5  （数值为555 000）

提供KB，MB或GB $a = 55mb  （将值转换为字节57671680）

提供一个命令 $a = Get-Alias

提供一个表达 `$a = if ($x -ge 5) { "Hello" } else { "World" } `

您将在下面看到的屏幕截图显示了$a基于上述示例的控制台内的变量输出

### `+=` 加法和赋值操作符
通过使用此运算符，我们可以对整数，字符串，数组和散列表执行操作。操作符将采取的操作取决于变量的类型和输入的类型。让我们看看下面的几个例子，并试图解释它们。 

通常，操作符首先执行加法，然后将该值赋给变量。下面的两行会产生相同的结果：

```
PS C:\> $a += 5
PS C:\> $a
57671685
PS C:\> $a = ($a + 5)
PS C:\> $a
57671690
```

如果该变量为空，则操作符将该值赋给该变量。如果变量是整数，则运算符将按指定的数字增加变量的数量。

我们可以使用赋值运算符来添加字符串和这里的字符串。以下示例显示了如何执行此操作。

```
PS C:\> $a = "free"
PS C:\> $a += "buf"
PS C:\> $a
freebuf
PS C:\> $a = @"
>> Hello World.
>> This is a beautiful day
>> "@
>>
PS C:\> $a
Hello World.
This is a beautiful day
PS C:\> $a += @"
>> `nThe sun is shining
>> "@
PS C:\> $a
Hello World.
This is a beautiful day
The sun is shining
```

当我们的变量是一个数组时，通过赋值操作符`+=`，我们可以在数组中添加项，可以逐个添加或者在数组中添加一个数组。当我们有一个数组时，我们只能对数组中的一个特定项目进行更改。我们能够执行与上面所示相同的更改。让我们看看下面的例子来更好地理解。

```
PS C:\> $a = 1,3,5,7,9
PS C:\> $a
1
3
5
7
9
PS C:\> $a += 30
PS C:\> $a
1
3
5
7
9
30
PS C:\> $a[3] += 7
PS C:\> $a
1
3
5
14
9
30
```

当我们想要将操作符用于散列表时，我们只允许添加另一个散列表。如果您尝试在散列表中添加任何其他类型，您将收到错误。以下示例显示您是否可以使用操作符的散列表。另请注意，您无法添加散列表中已存在的key。
```
PS C:\> $a = @{1 = "free"; 2 = "buf"}
PS C:\> $a

Name                           Value
----                           -----
2                              buf
1                              free


PS C:\> $a += @{4 = "power"; 5 = "shell"}
PS C:\> $a

Name                           Value
----                           -----
5                              shell
4                              power
2                              buf
1                              free
```
如果我们重复添加已存在的键值会报错
```
PS C:\> $a += @{4 = "power"; 5 = "shell"}
Item has already been added. Key in dictionary: '5'  Key being added:
 '5'
At line:1 char:1
+ $a += @{4 = "power"; 5 = "shell"}
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : OperationStopped: (:) [], ArgumentExce
   ption
    + FullyQualifiedErrorId : System.ArgumentException
```

操作符根据变量的类型处理更改。如果变量是System.Integer，它将以变量值的形式对变量值进行更改。如果变量类型是System.String，它将以字符串形式执行更改。即使它包含数字值，也可以强制变量为字符串。

### `-=` 减法和赋值运算符
与Addition和Assignment Operator不同，此运算符只能使用整数，并且无法从数组或散列表中删除任何项目。一般来说，这个过程与整数相同。以下几行执行相同的任务：
```
PS C:\> $a = 15
PS C:\> $a -= 5
PS C:\> $a
10
PS C:\> $a = ($a - 5)
PS C:\> $a
10
```
运算符将从变量中减去指定的整数。在数组的情况下，我们可以通过指定数组索引来使用操作符来修改数组中的项目。下面的例子会帮助你理解。
```
PS C:\> $a = 5,10,15
PS C:\> $a[2] -= 5
PS C:\> $a
5
10
10
```
### `*=`  乘法和赋值运算符
该操作符能够使用数字值和字符串。在我们有数值的情况下，操作符会将变量的当前值乘以您指定的值并将新值赋予变量。当变量包含字符串时，运算符将按照您指定的次数乘以字符串，组合字符串并将其分配给变量。如果我们有一个数组，我们只能通过指定项目的索引号来对数组中的项目执行操作。以下示例将帮助您更好地理解此操作符的用法。
```
PS C:\> $a = 10
PS C:\> $a *= 5
PS C:\> $a
50
PS C:\> $a = 5,10,15,20
PS C:\> $a[3] *= 5
PS C:\> $a
5
10
15
100
PS C:\> $a = "freebuf"
PS C:\> $a *= 5
PS C:\> $a
freebuffreebuffreebuffreebuffreebuf
```
### `/=` 除法操作符
将变量的值除以指定的值。下面的例子将向你展示这个运算符的用法，在我们的变量中有一个数值，还有一个数组变量，用于对数组中的项目进行更改。
```
PS C:\> $a = 10
PS C:\> $a /= 5
PS C:\> $a
2
PS C:\> $a = 5,10,15,20
PS C:\> $a[3] /= 5
PS C:\> $a
5
10
15
4
```
### `%=` 模量和赋值运算符
此运算符只能使用数值，或者作为数组中的项目使用。它将计算模数，然后将该值分配给数组中的变量。下面的例子会告诉你它的用法。

```
PS C:\> $a = 15
PS C:\> $a %= 4
PS C:\> $a
3
PS C:\> $a = 5,10,15
PS C:\> $a[2] %= 4
PS C:\> $a
5
10
3
```

### `++`  增量运算符
增量操作符只能使用数字值工作。运算符会将变量的当前值增加1.这也可以应用于数组中，以将数组中的项目的值增加1。操作符不会为您提供任何新值的输出。为了得到操作符的输出，你需要把它放在括号内( )。
```
PS C:\> $a = 5
PS C:\> ++$a
PS C:\> $a
6
PS C:\> $a++
PS C:\> $a
7
PS C:\> (++$a)
8
```
增量算子的位置对结果起着重要的作用。如果操作符位于变量之前，则操作符在变量值之前处理。如果放置在变量之后，则在变量值之后处理操作符。如果将操作符与变量括在括号内( )，则无关紧要，结果是相同的。检查下面的例子以了解其中的差异。 

```
PS C:\> $a = 5
PS C:\> $b = ++$a
PS C:\> $a
6
PS C:\> $b
6

PS C:\> $a = 5
PS C:\> $b = $a++
PS C:\> $a
6
PS C:\> $b
5

PS C:\> $a = 5
PS C:\> $b = (++$a)
PS C:\> $a
6
PS C:\> $b
6

PS C:\> $a = 5
PS C:\> $b = ($a++)
PS C:\> $a
6
PS C:\> $b
5
PS C:\> PS C:\> $a = 5
```

### `--` 递减运算符
递减运算符将变量的数值减1。它与增量运算符的工作方式完全相同。它仅适用于数组中的数值或不适用于数组。